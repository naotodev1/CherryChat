<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hanabi - Assistente</title>
<style>
/* ---------------- Hanabi ---------------- */
#hanabiContainer {
  position: fixed;
  bottom: 20px;
  left: 20px;
  width: 300px;
  max-height: 400px;
  background: #071425;
  border: 2px solid #ff6b81;
  border-radius: 10px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  z-index: 9980;
  font-family: sans-serif;
}
#hanabiHeader {background: #ff6b81;color:white;padding:8px;text-align:center;font-weight:bold;}
#hanabiMessages {flex:1;padding:5px;overflow-y:auto;font-size:14px;}
.hMessage.user {text-align:right;color:#FFD700;margin:3px 0;}
.hMessage.hanabi {text-align:left;color:#00FFFF;margin:3px 0;}
#hanabiInputArea {display:flex;border-top:1px solid #ff6b81;}
#hanabiInput {flex:1;padding:5px;border:none;outline:none;background:#0f2145;color:white;}
#hanabiSend {background:#ff6b81;border:none;color:white;padding:5px 10px;cursor:pointer;}
#hanabiReminders {padding:5px;margin-top:5px;}

/* ---------------- Aura ---------------- */
#auraCard {
  position: fixed;
  bottom: 90px;
  right: 20px;
  background: #0f2145;
  color: #00ffff;
  padding: 10px 15px;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  font-weight: bold;
  z-index: 9998;
  opacity: 1;
  transition: opacity 0.5s;
}
#auraBalloon {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #ff6b81;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 30px;
  color: white;
  z-index: 9999;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  transition: transform 0.2s;
}
#auraBalloon:hover {transform: scale(1.1);}
#auraChat {
  position: fixed;
  bottom: 90px;
  right: 20px;
  width: 300px;
  max-height: 400px;
  background: #071425;
  border: 2px solid #ff6b81;
  border-radius: 8px;
  display: none;
  flex-direction: column;
  overflow: hidden;
  z-index: 10000;
}
#auraChatHeader {background: #ff6b81;color:white;padding:8px;text-align:center;font-weight:bold;}
#auraMessages {flex:1;padding:5px;overflow-y:auto;font-size:14px;}
.aMessage.user {text-align:right;color:#FFD700;margin:3px 0;}
.aMessage.aura {text-align:left;color:#00ffff;margin:3px 0;}
#auraInputArea {display:flex;border-top:1px solid #ff6b81;}
#auraInput {flex:1;padding:5px;border:none;outline:none;background:#0f2145;color:white;}
#auraSend {background:#ff6b81;border:none;color:white;padding:5px 10px;cursor:pointer;}
</style>
</head>
<body>

<!-- ---------------- Hanabi ---------------- -->
<div id="hanabiContainer">
  <div id="hanabiHeader">Hanabi ✨ - Assistente Pessoal</div>
  <div id="hanabiMessages"></div>
  <div id="hanabiInputArea">
    <input type="text" id="hanabiInput" placeholder="Escreva aqui...">
    <button id="hanabiSend">Enviar</button>
  </div>
  <div id="hanabiReminders"></div>
</div>

<!-- ---------------- Aura ---------------- -->
<div id="auraCard">Posso ajudar?</div>
<div id="auraBalloon">💫</div>
<div id="auraChat">
  <div id="auraChatHeader">Aura - Assistente Studio Tsukiyo</div>
  <div id="auraMessages"></div>
  <div id="auraInputArea">
    <input type="text" id="auraInput" placeholder="Escreva aqui...">
    <button id="auraSend">Enviar</button>
  </div>
</div>

<script>
/* ---------------- Hanabi JS ---------------- */
const hMessages = document.getElementById('hanabiMessages');
const hInput = document.getElementById('hanabiInput');
const hSend = document.getElementById('hanabiSend');

function hAppend(msg,who){
  const div = document.createElement('div');
  div.className = 'hMessage '+who;
  div.textContent = msg;
  hMessages.appendChild(div);
  hMessages.scrollTop = hMessages.scrollHeight;
  if(who==='hanabi' && 'speechSynthesis' in window){
    const utter = new SpeechSynthesisUtterance(msg);
    utter.lang='pt-BR';
    window.speechSynthesis.speak(utter);
  }
  let db = JSON.parse(localStorage.getItem('hanabiDB')||'[]');
  db.push({who,msg,time:new Date().toISOString()});
  localStorage.setItem('hanabiDB',JSON.stringify(db));
}

function hLoad(){let db = JSON.parse(localStorage.getItem('hanabiDB')||'[]');db.forEach(d=>hAppend(d.msg,d.who));}

function hReply(msg){
  let t = msg.toLowerCase();
  const responses = [
    "Oi! Eu sou Hanabi, sua assistente pessoal.",
    "Quer ajuda com alarmes ou lembretes?",
    "Você pode me perguntar qualquer coisa!",
    "Posso te dar dicas de leitura ou automações.",
    "Vamos explorar novas funções juntos!",
    "Quer salvar um lembrete?",
    "Precisa de ajuda com tarefas?",
    "Vamos conversar sobre qualquer assunto!"
  ];
  if(t.includes("alarme")) return "⏰ Posso criar um alarme para você!";
  if(t.includes("lembrete")) return "📝 Posso salvar um lembrete visual para você!";
  if(t.includes("hora")||t.includes("data")) return "📅 Agora mesmo: "+new Date().toLocaleString();
  return responses[Math.floor(Math.random()*responses.length)];
}

hSend.onclick=()=>{
  let txt=hInput.value.trim();
  if(!txt) return;
  hAppend(txt,'user');
  hInput.value='';
  let reply=hReply(txt);
  setTimeout(()=>hAppend(reply,'hanabi'),300);
}
hInput.addEventListener("keypress",(e)=>{if(e.key==='Enter'){hSend.click();}});
hLoad();

/* ---------------- Aura JS ---------------- */
// Card desaparece
setTimeout(()=>{document.getElementById('auraCard').style.opacity=0;},5000);

const aBalloon = document.getElementById('auraBalloon');
const aChat = document.getElementById('auraChat');
const aMessages = document.getElementById('auraMessages');
const aInput = document.getElementById('auraInput');
const aSend = document.getElementById('auraSend');

aBalloon.onclick=()=>{aChat.style.display=aChat.style.display==='flex'?'none':'flex';};

function aAppend(msg,who){
  const div=document.createElement('div');
  div.className='aMessage '+who;
  div.textContent=msg;
  aMessages.appendChild(div);
  aMessages.scrollTop = aMessages.scrollHeight;
  if(who==='aura' && 'speechSynthesis' in window){
    const utter = new SpeechSynthesisUtterance(msg);
    utter.lang='pt-BR';
    window.speechSynthesis.speak(utter);
  }
  let db = JSON.parse(localStorage.getItem('auraDB')||'[]');
  db.push({who,msg,time:new Date().toISOString()});
  localStorage.setItem('auraDB',JSON.stringify(db));
}

function aLoad(){let db = JSON.parse(localStorage.getItem('auraDB')||'[]');db.forEach(d=>aAppend(d.msg,d.who));}

function aReply(msg){
  let t = msg.toLowerCase();
  const responses = [
    "Oi! Eu sou a Aura, sua assistente do Studio Tsukiyo.",
    "Você pode me perguntar sobre nossos livros, cursos ou redes sociais.",
    "Confira a aba Produtos para links e obras.",
    "Tsukiyo Writer Class oferece cursos de escrita criativa.",
    "Abunai Aisuru é nossa obra mais intensa.",
    "Married at 16 é cheia de drama e romance.",
    "Emilly: Além do Horizonte é cheia de aventuras.",
    "Kizuite Kudassai - Please Notice Me é muito popular!",
    "Nosso Instagram, Facebook e TikTok possuem novidades diárias.",
    "Quer que eu te indique alguma obra ou curso?"
  ];
  if(t.includes("livro")||t.includes("obra")) return "📚 Confira nossos livros na aba Produtos!";
  if(t.includes("curso")||t.includes("escola")) return "🎓 Tsukiyo Writer Class na aba Produtos!";
  if(t.includes("instagram")||t.includes("facebook")||t.includes("tiktok")) return "Veja nossos links de redes sociais na aba Produtos!";
  if(t.includes("oi")||t.includes("olá")||t.includes("hey")) return responses[0];
  return responses[Math.floor(Math.random()*responses.length)];
}

aSend.onclick=()=>{
  let txt=aInput.value.trim();
  if(!txt) return;
  aAppend(txt,'user');
  aInput.value='';
  let reply=aReply(txt);
  setTimeout(()=>aAppend(reply,'aura'),300);
}
aInput.addEventListener("keypress",(e)=>{if(e.key==='Enter'){aSend.click();}});
aLoad();
</script>

</body>
</html>
