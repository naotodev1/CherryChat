<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hanabi - Assistente Studio Tsukiyo</title>
<link rel="manifest" href="manifest.json">
<style>
body {margin:0;font-family:sans-serif;background:#071425;color:white;}
header {background:#ff6b81;padding:1rem;text-align:center;font-size:1.4rem;font-weight:bold;}
nav{display:flex;justify-content:space-around;background:#ff2b81;}
nav button{flex:1;padding:0.8rem;background:none;color:white;border:none;font-weight:bold;font-size:1rem;}
nav button.active{background:#ff4567;}
main{padding:1rem;min-height:80vh;}
#chatBox{height:50vh;overflow-y:auto;border:1px solid #ff4567;padding:0.5rem;margin-bottom:0.5rem;background:#071b35;}
.message{margin:0.2rem 0;}
.message.user{text-align:right;color:#FFD700;}
.message.hanabi{text-align:left;color:#00FFFF;}
input[type="text"]{width:80%;padding:0.5rem;}
button.send{padding:0.5rem 1rem;background:#ff6b81;border:none;color:white;font-weight:bold;}
.card{background:#0f2145;padding:0.5rem;margin:0.5rem 0;border-radius:6px;border:1px solid #ff4567;}
</style>
</head>
<body>

<header>Hanabi ‚ú® - Assistente</header>
<nav>
<button id="tabChat" class="active">Chat</button>
<button id="tabProducts">Produtos</button>
<button id="tabPolicies">Pol√≠ticas</button>
</nav>

<main>
<!-- Chat -->
<div id="chatSection">
  <div id="chatBox"></div>
  <input type="text" id="chatInput" placeholder="Escreva aqui...">
  <button class="send" id="sendBtn">Enviar</button>
</div>

<!-- Produtos -->
<div id="productsSection" style="display:none;">
  <div class="card"><b>Por Favor, Me Note</b> - Light Novel original.</div>
  <div class="card"><b>Kenji Animes</b> - P√°gina de cultura otaku.</div>
  <div class="card"><b>Tsukiyo Writer School</b> - Cursos e mentorias.</div>
</div>

<!-- Pol√≠ticas -->
<div id="policiesSection" style="display:none;">
  <div class="card"><b>Termos de Uso</b>: Ao usar nossos produtos, voc√™ concorda com os termos Studio Tsukiyo Platforms.</div>
  <div class="card"><b>Pol√≠tica de Privacidade</b>: Seu uso √© registrado apenas localmente e usamos seu feedback para melhoria. Contato: <a href="mailto:sac.studiotsukiyo@outlook.com">sac.studiotsukiyo@outlook.com</a></div>
</div>

</main>

<script>
// ---------- Tabs ----------
const tabChat = document.getElementById('tabChat');
const tabProducts = document.getElementById('tabProducts');
const tabPolicies = document.getElementById('tabPolicies');
const chatSection = document.getElementById('chatSection');
const productsSection = document.getElementById('productsSection');
const policiesSection = document.getElementById('policiesSection');

tabChat.onclick = ()=>{chatSection.style.display='block';productsSection.style.display='none';policiesSection.style.display='none';setActive(tabChat);}
tabProducts.onclick = ()=>{chatSection.style.display='none';productsSection.style.display='block';policiesSection.style.display='none';setActive(tabProducts);}
tabPolicies.onclick = ()=>{chatSection.style.display='none';productsSection.style.display='none';policiesSection.style.display='block';setActive(tabPolicies);}
function setActive(el){[tabChat,tabProducts,tabPolicies].forEach(b=>b.classList.remove('active'));el.classList.add('active');}

// ---------- Chat ----------
const chatBox = document.getElementById('chatBox');
const chatInput = document.getElementById('chatInput');
const sendBtn = document.getElementById('sendBtn');

function appendMessage(text,who){
  const div=document.createElement('div');
  div.className='message '+who;
  div.textContent=text;
  chatBox.appendChild(div);
  chatBox.scrollTop=chatBox.scrollHeight;
}

function generateReply(msg){
  let t=msg.toLowerCase();
  if(t.includes("alarme")) return "‚è∞ Alarme: ainda n√£o implementado no browser, mas posso lembrar localmente!";
  if(t.includes("lembrete")) return "üìù Lembrete salvo localmente!";
  if(t.includes("livro")) return "üìö Temos Light Novels e hist√≥rias originais. Veja Produtos!";
  if(t.includes("curso")) return "üéì Escola de Novos Autores: cursos e mentorias dispon√≠veis.";
  if(t.includes("naoto")) return "üíª Espa√ßo Naoto Developer: tutoriais e automa√ß√µes.";
  if(t.includes("oi")||t.includes("ol√°")) return "Oi! Eu sou Hanabi. Posso te ajudar com nossos produtos.";
  return "Desculpe, n√£o entendi. Pergunte sobre livros, cursos ou digite 'ajuda'.";
}

function saveMessage(user,msg){
  let db=JSON.parse(localStorage.getItem("hanabiDB")||"[]");
  db.push({user:user,msg:msg,time:new Date().toISOString()});
  localStorage.setItem("hanabiDB",JSON.stringify(db));
}

function loadMessages(){
  let db=JSON.parse(localStorage.getItem("hanabiDB")||"[]");
  db.forEach(d=>appendMessage(d.msg,d.user));
}

sendBtn.onclick=()=>{
  let txt=chatInput.value.trim();
  if(!txt)return;
  appendMessage(txt,'user');
  saveMessage('user',txt);
  chatInput.value='';
  let reply=generateReply(txt);
  setTimeout(()=>{appendMessage(reply,'hanabi');saveMessage('hanabi',reply);},300);
}

// Load history
loadMessages();
</script>

</body>
</html>
